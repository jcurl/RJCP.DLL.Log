<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="651px" preserveAspectRatio="none" style="width:825px;height:651px;background:#FFFFFF;" version="1.1" viewBox="0 0 825 651" width="825px" zoomAndPan="magnify"><defs><filter height="300%" id="fbdw1pxz29y1h" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fbdw1pxz29y1h)" height="537" style="stroke:#000000;stroke-width:1.5;" width="806" x="7" y="102"/><!--MD5=[8d1dd90e5d7d6fdc16fd2156eabaab92]
class IPcapBlock--><rect codeLine="5" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="75.6719" id="IPcapBlock" style="stroke:#A80036;stroke-width:1.5;" width="95" x="491.5" y="547"/><ellipse cx="506.5" cy="563" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M507.4531,559.6406 L507.4531,566.2969 L509.1719,566.2969 Q509.7813,566.2969 510.0469,566.5313 Q510.3125,566.7656 510.3125,567.1563 Q510.3125,567.5313 510.0469,567.7656 Q509.7813,568 509.1719,568 L504.0313,568 Q503.4219,568 503.1563,567.7656 Q502.8906,567.5313 502.8906,567.1406 Q502.8906,566.7656 503.1563,566.5313 Q503.4219,566.2969 504.0313,566.2969 L505.75,566.2969 L505.75,559.6406 L504.0313,559.6406 Q503.4219,559.6406 503.1563,559.4063 Q502.8906,559.1719 502.8906,558.7813 Q502.8906,558.4063 503.1563,558.1719 Q503.4219,557.9375 504.0313,557.9375 L509.1719,557.9375 Q509.7813,557.9375 510.0469,558.1719 Q510.3125,558.4063 510.3125,558.7813 Q510.3125,559.1719 510.0469,559.4063 Q509.7813,559.6406 509.1719,559.6406 L507.4531,559.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63" x="520.5" y="567.9102">IPcapBlock</text><line style="stroke:#A80036;stroke-width:1.5;" x1="492.5" x2="585.5" y1="579" y2="579"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="51" x="497.5" y="594.4189">BlockId: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="497.5" y="608.2549">Length: int</text><line style="stroke:#A80036;stroke-width:1.5;" x1="492.5" x2="585.5" y1="614.6719" y2="614.6719"/><!--MD5=[4dae4dfb6780914349677e19dbd01aa8]
class BlockReader--><rect codeLine="10" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="144.8516" id="BlockReader" style="stroke:#A80036;stroke-width:1.5;" width="310" x="384" y="118"/><ellipse cx="499.25" cy="134" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M502.0156,129.875 Q502.1719,129.6563 502.3594,129.5469 Q502.5469,129.4375 502.7656,129.4375 Q503.1406,129.4375 503.375,129.6953 Q503.6094,129.9531 503.6094,130.5625 L503.6094,132.0156 Q503.6094,132.625 503.375,132.8906 Q503.1406,133.1563 502.7656,133.1563 Q502.4219,133.1563 502.2188,132.9531 Q502.0156,132.7656 501.9063,132.25 Q501.8594,131.8906 501.6719,131.7031 Q501.3438,131.3281 500.7344,131.1094 Q500.125,130.8906 499.5,130.8906 Q498.7344,130.8906 498.1016,131.2188 Q497.4688,131.5469 496.9766,132.2969 Q496.4844,133.0469 496.4844,134.0781 L496.4844,135.1719 Q496.4844,136.4063 497.375,137.2266 Q498.2656,138.0469 499.8594,138.0469 Q500.7969,138.0469 501.4531,137.7969 Q501.8438,137.6406 502.2656,137.2031 Q502.5313,136.9375 502.6797,136.8594 Q502.8281,136.7813 503.0313,136.7813 Q503.3594,136.7813 503.6172,137.0391 Q503.875,137.2969 503.875,137.6406 Q503.875,137.9844 503.5313,138.3906 Q503.0313,138.9688 502.2344,139.2969 Q501.1563,139.75 499.8594,139.75 Q498.3438,139.75 497.1406,139.125 Q496.1563,138.625 495.4688,137.5547 Q494.7813,136.4844 494.7813,135.2031 L494.7813,134.0469 Q494.7813,132.7188 495.3984,131.5703 Q496.0156,130.4219 497.1094,129.8047 Q498.2031,129.1875 499.4375,129.1875 Q500.1719,129.1875 500.8203,129.3516 Q501.4688,129.5156 502.0156,129.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="519.75" y="138.9102">BlockReader</text><line style="stroke:#A80036;stroke-width:1.5;" x1="385" x2="693" y1="150" y2="150"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="392" y="158"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="102" x="404" y="165.4189">m_IsLittleEndian: bool</text><line style="stroke:#A80036;stroke-width:1.5;" x1="385" x2="693" y1="171.8359" y2="171.8359"/><ellipse cx="395" cy="182.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="257" x="404" y="187.2549">GetHeader(buffer: ReadOnlySpan&lt;byte&gt;): PcapBlock</text><ellipse cx="395" cy="196.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="264" x="404" y="201.0908">GetBlock(buffer: ReadOnlySpan&lt;byte&gt;, position: long):</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="52" x="410" y="214.9268">IPcapBlock</text><ellipse cx="395" cy="224.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="284" x="404" y="228.7627">DecodeBlock(buffer: ReadOnlySpan&lt;byte&gt;, position: long):</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="155" x="410" y="242.5986">IEnumerable&lt;DltTraceLineBase&gt;</text><ellipse cx="395" cy="252.0156" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="404" y="256.4346">Reset()</text><path d="M165,144.5 L165,236.2578 A0,0 0 0 0 165,236.2578 L349,236.2578 A0,0 0 0 0 349,236.2578 L349,194.5 L383.72,190.5 L349,186.5 L349,154.5 L339,144.5 L165,144.5 A0,0 0 0 0 165,144.5 " fill="#FBFB77" filter="url(#fbdw1pxz29y1h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M339,144.5 L339,154.5 L349,154.5 L339,144.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="171" y="162.9951">The BlockReader is stateful,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="171" y="179.3467">it must first receive a SHB</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="171" y="195.6982">to get the endianness, then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="171" y="212.0498">it can decode the other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="171" y="228.4014">blocks in order.</text><!--MD5=[6414fa426f7004c0537880be765ce0dc]
class PcapBlock--><rect codeLine="25" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="48" id="PcapBlock" style="stroke:#A80036;stroke-width:1.5;" width="90" x="707" y="389.5"/><ellipse cx="722" cy="405.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M724.7656,401.375 Q724.9219,401.1563 725.1094,401.0469 Q725.2969,400.9375 725.5156,400.9375 Q725.8906,400.9375 726.125,401.1953 Q726.3594,401.4531 726.3594,402.0625 L726.3594,403.5156 Q726.3594,404.125 726.125,404.3906 Q725.8906,404.6563 725.5156,404.6563 Q725.1719,404.6563 724.9688,404.4531 Q724.7656,404.2656 724.6563,403.75 Q724.6094,403.3906 724.4219,403.2031 Q724.0938,402.8281 723.4844,402.6094 Q722.875,402.3906 722.25,402.3906 Q721.4844,402.3906 720.8516,402.7188 Q720.2188,403.0469 719.7266,403.7969 Q719.2344,404.5469 719.2344,405.5781 L719.2344,406.6719 Q719.2344,407.9063 720.125,408.7266 Q721.0156,409.5469 722.6094,409.5469 Q723.5469,409.5469 724.2031,409.2969 Q724.5938,409.1406 725.0156,408.7031 Q725.2813,408.4375 725.4297,408.3594 Q725.5781,408.2813 725.7813,408.2813 Q726.1094,408.2813 726.3672,408.5391 Q726.625,408.7969 726.625,409.1406 Q726.625,409.4844 726.2813,409.8906 Q725.7813,410.4688 724.9844,410.7969 Q723.9063,411.25 722.6094,411.25 Q721.0938,411.25 719.8906,410.625 Q718.9063,410.125 718.2188,409.0547 Q717.5313,407.9844 717.5313,406.7031 L717.5313,405.5469 Q717.5313,404.2188 718.1484,403.0703 Q718.7656,401.9219 719.8594,401.3047 Q720.9531,400.6875 722.1875,400.6875 Q722.9219,400.6875 723.5703,400.8516 Q724.2188,401.0156 724.7656,401.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="736" y="410.4102">PcapBlock</text><line style="stroke:#A80036;stroke-width:1.5;" x1="708" x2="796" y1="421.5" y2="421.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="708" x2="796" y1="429.5" y2="429.5"/><!--MD5=[e6c6632931931e19429e38782ae51963]
class SectionHeaderBlock--><rect codeLine="29" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="117.1797" id="SectionHeaderBlock" style="stroke:#A80036;stroke-width:1.5;" width="266" x="406" y="355"/><ellipse cx="478.75" cy="371" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M481.5156,366.875 Q481.6719,366.6563 481.8594,366.5469 Q482.0469,366.4375 482.2656,366.4375 Q482.6406,366.4375 482.875,366.6953 Q483.1094,366.9531 483.1094,367.5625 L483.1094,369.0156 Q483.1094,369.625 482.875,369.8906 Q482.6406,370.1563 482.2656,370.1563 Q481.9219,370.1563 481.7188,369.9531 Q481.5156,369.7656 481.4063,369.25 Q481.3594,368.8906 481.1719,368.7031 Q480.8438,368.3281 480.2344,368.1094 Q479.625,367.8906 479,367.8906 Q478.2344,367.8906 477.6016,368.2188 Q476.9688,368.5469 476.4766,369.2969 Q475.9844,370.0469 475.9844,371.0781 L475.9844,372.1719 Q475.9844,373.4063 476.875,374.2266 Q477.7656,375.0469 479.3594,375.0469 Q480.2969,375.0469 480.9531,374.7969 Q481.3438,374.6406 481.7656,374.2031 Q482.0313,373.9375 482.1797,373.8594 Q482.3281,373.7813 482.5313,373.7813 Q482.8594,373.7813 483.1172,374.0391 Q483.375,374.2969 483.375,374.6406 Q483.375,374.9844 483.0313,375.3906 Q482.5313,375.9688 481.7344,376.2969 Q480.6563,376.75 479.3594,376.75 Q477.8438,376.75 476.6406,376.125 Q475.6563,375.625 474.9688,374.5547 Q474.2813,373.4844 474.2813,372.2031 L474.2813,371.0469 Q474.2813,369.7188 474.8984,368.5703 Q475.5156,367.4219 476.6094,366.8047 Q477.7031,366.1875 478.9375,366.1875 Q479.6719,366.1875 480.3203,366.3516 Q480.9688,366.5156 481.5156,366.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="112" x="499.25" y="375.9102">SectionHeaderBlock</text><line style="stroke:#A80036;stroke-width:1.5;" x1="407" x2="671" y1="387" y2="387"/><ellipse cx="417" cy="398" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="426" y="402.4189">IsLittleEndian: bool</text><ellipse cx="417" cy="411.8359" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="426" y="416.2549">MajorVersion: int</text><ellipse cx="417" cy="425.6719" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="426" y="430.0908">MinorVersion: int</text><ellipse cx="417" cy="439.5078" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="426" y="443.9268">Options: PcapOptions</text><line style="stroke:#A80036;stroke-width:1.0;" x1="407" x2="671" y1="450.3438" y2="450.3438"/><polygon fill="#4177AF" points="417,457.3438,413,463.3438,421,463.3438" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="240" x="426" y="465.7627">.ctor(buffer: ReadOnlySpan&lt;byte&gt;, position: long)</text><!--MD5=[96a715c847763fc1bc947c53b7a67285]
class InterfaceDescriptionBlock--><rect codeLine="40" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="144.8516" id="InterfaceDescriptionBlock" style="stroke:#A80036;stroke-width:1.5;" width="348" x="23" y="341"/><ellipse cx="122.75" cy="357" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M125.5156,352.875 Q125.6719,352.6563 125.8594,352.5469 Q126.0469,352.4375 126.2656,352.4375 Q126.6406,352.4375 126.875,352.6953 Q127.1094,352.9531 127.1094,353.5625 L127.1094,355.0156 Q127.1094,355.625 126.875,355.8906 Q126.6406,356.1563 126.2656,356.1563 Q125.9219,356.1563 125.7188,355.9531 Q125.5156,355.7656 125.4063,355.25 Q125.3594,354.8906 125.1719,354.7031 Q124.8438,354.3281 124.2344,354.1094 Q123.625,353.8906 123,353.8906 Q122.2344,353.8906 121.6016,354.2188 Q120.9688,354.5469 120.4766,355.2969 Q119.9844,356.0469 119.9844,357.0781 L119.9844,358.1719 Q119.9844,359.4063 120.875,360.2266 Q121.7656,361.0469 123.3594,361.0469 Q124.2969,361.0469 124.9531,360.7969 Q125.3438,360.6406 125.7656,360.2031 Q126.0313,359.9375 126.1797,359.8594 Q126.3281,359.7813 126.5313,359.7813 Q126.8594,359.7813 127.1172,360.0391 Q127.375,360.2969 127.375,360.6406 Q127.375,360.9844 127.0313,361.3906 Q126.5313,361.9688 125.7344,362.2969 Q124.6563,362.75 123.3594,362.75 Q121.8438,362.75 120.6406,362.125 Q119.6563,361.625 118.9688,360.5547 Q118.2813,359.4844 118.2813,358.2031 L118.2813,357.0469 Q118.2813,355.7188 118.8984,354.5703 Q119.5156,353.4219 120.6094,352.8047 Q121.7031,352.1875 122.9375,352.1875 Q123.6719,352.1875 124.3203,352.3516 Q124.9688,352.5156 125.5156,352.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="143.25" y="361.9102">InterfaceDescriptionBlock</text><line style="stroke:#A80036;stroke-width:1.5;" x1="24" x2="370" y1="373" y2="373"/><ellipse cx="34" cy="384" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="43" y="388.4189">LinkType: int</text><ellipse cx="34" cy="397.8359" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="69" x="43" y="402.2549">SnapLen: long</text><ellipse cx="34" cy="411.6719" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="43" y="416.0908">Options: PcapOptions</text><line style="stroke:#A80036;stroke-width:1.0;" x1="24" x2="370" y1="422.5078" y2="422.5078"/><polygon fill="#4177AF" points="34,429.5078,30,435.5078,38,435.5078" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="319" x="43" y="437.9268">.ctor(buffer: ReadOnlySpan&lt;byte&gt;, bool littleEndian, position: long)</text><ellipse cx="34" cy="447.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="43" y="451.7627">GetTimeStamp(high: uint, low: uint): DateTime</text><ellipse cx="34" cy="461.1797" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="322" x="43" y="465.5986">DecodePacket(buffer: ReadOnlySpan&lt;byte&gt;, timeStamp: DateTime,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="228" x="49" y="479.4346">position: long): IEnumerable&lt;DltTraceLineBase&gt;</text><!--MD5=[7b682d4fb164593493a4c0dbc33aac53]
class PacketDecoder--><rect codeLine="52" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="48" id="PacketDecoder" style="stroke:#A80036;stroke-width:1.5;" width="116" x="139" y="561"/><ellipse cx="154" cy="577" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M156.7656,572.875 Q156.9219,572.6563 157.1094,572.5469 Q157.2969,572.4375 157.5156,572.4375 Q157.8906,572.4375 158.125,572.6953 Q158.3594,572.9531 158.3594,573.5625 L158.3594,575.0156 Q158.3594,575.625 158.125,575.8906 Q157.8906,576.1563 157.5156,576.1563 Q157.1719,576.1563 156.9688,575.9531 Q156.7656,575.7656 156.6563,575.25 Q156.6094,574.8906 156.4219,574.7031 Q156.0938,574.3281 155.4844,574.1094 Q154.875,573.8906 154.25,573.8906 Q153.4844,573.8906 152.8516,574.2188 Q152.2188,574.5469 151.7266,575.2969 Q151.2344,576.0469 151.2344,577.0781 L151.2344,578.1719 Q151.2344,579.4063 152.125,580.2266 Q153.0156,581.0469 154.6094,581.0469 Q155.5469,581.0469 156.2031,580.7969 Q156.5938,580.6406 157.0156,580.2031 Q157.2813,579.9375 157.4297,579.8594 Q157.5781,579.7813 157.7813,579.7813 Q158.1094,579.7813 158.3672,580.0391 Q158.625,580.2969 158.625,580.6406 Q158.625,580.9844 158.2813,581.3906 Q157.7813,581.9688 156.9844,582.2969 Q155.9063,582.75 154.6094,582.75 Q153.0938,582.75 151.8906,582.125 Q150.9063,581.625 150.2188,580.5547 Q149.5313,579.4844 149.5313,578.2031 L149.5313,577.0469 Q149.5313,575.7188 150.1484,574.5703 Q150.7656,573.4219 151.8594,572.8047 Q152.9531,572.1875 154.1875,572.1875 Q154.9219,572.1875 155.5703,572.3516 Q156.2188,572.5156 156.7656,572.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="168" y="581.9102">PacketDecoder</text><line style="stroke:#A80036;stroke-width:1.5;" x1="140" x2="254" y1="593" y2="593"/><line style="stroke:#A80036;stroke-width:1.5;" x1="140" x2="254" y1="601" y2="601"/><!--MD5=[00add8ed846e2c7ba81e668223418f3a]
class DltPcapNgDecoder--><rect codeLine="2" fill="#FEFECE" filter="url(#fbdw1pxz29y1h)" height="48" id="DltPcapNgDecoder" style="stroke:#A80036;stroke-width:1.5;" width="138" x="470" y="7"/><ellipse cx="485" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M487.7656,18.875 Q487.9219,18.6563 488.1094,18.5469 Q488.2969,18.4375 488.5156,18.4375 Q488.8906,18.4375 489.125,18.6953 Q489.3594,18.9531 489.3594,19.5625 L489.3594,21.0156 Q489.3594,21.625 489.125,21.8906 Q488.8906,22.1563 488.5156,22.1563 Q488.1719,22.1563 487.9688,21.9531 Q487.7656,21.7656 487.6563,21.25 Q487.6094,20.8906 487.4219,20.7031 Q487.0938,20.3281 486.4844,20.1094 Q485.875,19.8906 485.25,19.8906 Q484.4844,19.8906 483.8516,20.2188 Q483.2188,20.5469 482.7266,21.2969 Q482.2344,22.0469 482.2344,23.0781 L482.2344,24.1719 Q482.2344,25.4063 483.125,26.2266 Q484.0156,27.0469 485.6094,27.0469 Q486.5469,27.0469 487.2031,26.7969 Q487.5938,26.6406 488.0156,26.2031 Q488.2813,25.9375 488.4297,25.8594 Q488.5781,25.7813 488.7813,25.7813 Q489.1094,25.7813 489.3672,26.0391 Q489.625,26.2969 489.625,26.6406 Q489.625,26.9844 489.2813,27.3906 Q488.7813,27.9688 487.9844,28.2969 Q486.9063,28.75 485.6094,28.75 Q484.0938,28.75 482.8906,28.125 Q481.9063,27.625 481.2188,26.5547 Q480.5313,25.4844 480.5313,24.2031 L480.5313,23.0469 Q480.5313,21.7188 481.1484,20.5703 Q481.7656,19.4219 482.8594,18.8047 Q483.9531,18.1875 485.1875,18.1875 Q485.9219,18.1875 486.5703,18.3516 Q487.2188,18.5156 487.7656,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="106" x="499" y="27.9102">DltPcapNgDecoder</text><line style="stroke:#A80036;stroke-width:1.5;" x1="471" x2="607" y1="39" y2="39"/><line style="stroke:#A80036;stroke-width:1.5;" x1="471" x2="607" y1="47" y2="47"/><!--MD5=[518f78372815a2bfc1e9f2b1a1aeef5f]
link BlockReader to PcapBlock--><path codeLine="26" d="M613.48,263.02 C638.23,287.37 665.67,315.01 690,341 C703.33,355.24 717.63,371.65 729.13,385.15 " fill="none" id="BlockReader-to-PcapBlock" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="732.61,389.25,729.8279,379.8023,729.3713,385.4407,723.7329,384.9841,732.61,389.25" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="658" y="307.4951">«create»</text><!--MD5=[0ac1970b238c347b17aa5b5a0ea5e2c0]
link PcapBlock to IPcapBlock--><path codeLine="27" d="M734.76,437.56 C723.06,452.35 706.73,471.44 690,486 C663.79,508.8 631.88,530.28 604.15,547.28 " fill="none" id="PcapBlock-to-IPcapBlock" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="607.39,553.5,586.64,557.78,600.19,541.49,607.39,553.5" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[66605bbd2081f4658b8ffca9401d184b]
reverse link BlockReader to SectionHeaderBlock--><path codeLine="37" d="M539,276.33 C539,302.54 539,330.79 539,354.72 " fill="none" id="BlockReader-backto-SectionHeaderBlock" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="539,263.25,535,269.25,539,275.25,543,269.25,539,263.25" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[187ff037c20539cc446bd3ef25a46db8]
link SectionHeaderBlock to IPcapBlock--><path codeLine="38" d="M539,472.36 C539,489.88 539,509.11 539,526.61 " fill="none" id="SectionHeaderBlock-to-IPcapBlock" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="546,526.85,539,546.85,532,526.85,546,526.85" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a5f4873002f68a71998a88364b97fcb0]
reverse link BlockReader to InterfaceDescriptionBlock--><path codeLine="49" d="M417.01,270.33 C381.39,293.35 342.66,318.37 307.77,340.92 " fill="none" id="BlockReader-backto-InterfaceDescriptionBlock" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="427.96,263.25,420.7496,263.1489,417.883,269.7657,425.0934,269.8669,427.96,263.25" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="410.0429" y="284.4654">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="298.1619" y="330.1311">0..*</text><!--MD5=[b09b82df7b676d99f2d0a745d90562a2]
link InterfaceDescriptionBlock to IPcapBlock--><path codeLine="50" d="M341.54,486.14 C387.39,508.86 435.85,532.88 473.28,551.43 " fill="none" id="InterfaceDescriptionBlock-to-IPcapBlock" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="476.43,545.18,491.24,560.33,470.21,557.72,476.43,545.18" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[7edfba12bcc3b5a421ff4e6a60c06cbe]
reverse link InterfaceDescriptionBlock to PacketDecoder--><path codeLine="53" d="M197,499.62 C197,522.18 197,544.7 197,560.8 " fill="none" id="InterfaceDescriptionBlock-backto-PacketDecoder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="197,486.38,193,492.38,197,498.38,201,492.38,197,486.38" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[83b4f31b5c25071e79776cc8c77d8532]
reverse link DltPcapNgDecoder to BlockReader--><path codeLine="56" d="M539,68.37 C539,83.08 539,100.59 539,117.67 " fill="none" id="DltPcapNgDecoder-backto-BlockReader" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="539,55.24,535,61.24,539,67.24,543,61.24,539,55.24" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[09eeabb16f7d604c4125d288b10447e9]
@startuml DltPcapNgTraceDecoder

class DltPcapNgDecoder

rectangle {
    interface IPcapBlock {
        BlockId: int
        Length: int
    }

    class BlockReader {
        -m_IsLittleEndian: bool
        +GetHeader(buffer: ReadOnlySpan<byte>): PcapBlock
        +GetBlock(buffer: ReadOnlySpan<byte>, position: long):\n  IPcapBlock
        +DecodeBlock(buffer: ReadOnlySpan<byte>, position: long):\n  IEnumerable<DltTraceLineBase>
        +Reset()
    }
    note left {
        The BlockReader is stateful,
        it must first receive a SHB
        to get the endianness, then
        it can decode the other
        blocks in order.
    }

    class PcapBlock
    BlockReader -d-> PcapBlock : <<create>>
    IPcapBlock <|.u. PcapBlock

    class SectionHeaderBlock {
        +IsLittleEndian: bool
        +MajorVersion: int
        +MinorVersion: int
        +Options: PcapOptions
        - -
        ~.ctor(buffer: ReadOnlySpan<byte>, position: long)
    }
    BlockReader *-d- SectionHeaderBlock
    IPcapBlock <|.u. SectionHeaderBlock

    class InterfaceDescriptionBlock {
        +LinkType: int
        +SnapLen: long
        +Options: PcapOptions
        - -
        ~.ctor(buffer: ReadOnlySpan<byte>, bool littleEndian, position: long)
        +GetTimeStamp(high: uint, low: uint): DateTime
        +DecodePacket(buffer: ReadOnlySpan<byte>, timeStamp: DateTime,\n  position: long): IEnumerable<DltTraceLineBase>
    }
    BlockReader "1" *-d- "0..*" InterfaceDescriptionBlock
    IPcapBlock <|.u. InterfaceDescriptionBlock

    class PacketDecoder
    InterfaceDescriptionBlock *-d- PacketDecoder
}

DltPcapNgDecoder *-d- BlockReader

@enduml

PlantUML version 1.2022.0(Tue Jan 11 17:16:42 CET 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>